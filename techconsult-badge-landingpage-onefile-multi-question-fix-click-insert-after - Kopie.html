<!DOCTYPE html>
<html lang="de" data-theme="green">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>techconsult // console</title>
  <meta name="description" content="techconsult – Research & Insights for IT-Decision Makers." />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
  :root { --bg:#0a0a0a; --fg:#22c55e; --fg-orange:#f97316; --card:#0f0f0f; --muted:rgba(255,255,255,.6); }
  html[data-theme="orange"] { --fg: var(--fg-orange); }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:'Roboto Mono',ui-monospace,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  .wrap{min-height:100vh;display:grid;place-items:center;padding:24px}
  .card{width:min(980px,100%);background:var(--card);border:1px solid var(--fg);border-radius:16px;padding:28px;position:relative;box-shadow:0 10px 50px rgba(0,0,0,.6)}
  .header{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:20px}
  .header-left{display:flex;align-items:center;gap:10px}
  .header h1{font-size:16px;margin:0;font-weight:600;letter-spacing:.2px}
  .dot{width:10px;height:10px;border-radius:50%;background:var(--fg);display:inline-block}
  .badge{font-size:12px;padding:4px 8px;border:1px solid currentColor;border-radius:8px;opacity:.85}
  .type-area .line,.line{line-height:1.6}
  .type-area .cursor{display:inline-block;width:10px;height:18px;background:currentColor;vertical-align:-3px;animation:blink 1s steps(1,end) infinite;margin-left:6px}
  @keyframes blink{50%{opacity:0}}
  .block{border:1px solid currentColor;border-radius:12px;padding:16px;margin:18px 0;background:transparent;transition:opacity .6s ease}
  .block-title{opacity:.85;margin-bottom:10px}
  .btn-row{display:flex;gap:10px;flex-wrap:wrap}
  .btn{appearance:none;background:transparent;color:inherit;border:1px solid currentColor;border-radius:10px;padding:10px 14px;font-family:inherit;font-size:14px;cursor:pointer;text-decoration:none;display:inline-block;transition:transform .08s ease,opacity .2s ease}
  .btn:hover{transform:translateY(-1px)}
  .btn:active{transform:translateY(0);opacity:.85}
  .btn[disabled]{opacity:.55;cursor:not-allowed;transform:none!important}
  .text{opacity:.92;line-height:1.7}
  .muted{margin-top:8px;color:var(--muted);font-size:13px}
  .footer{margin-top:24px;padding-top:16px;border-top:1px solid currentColor;display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;font-size:12px;opacity:.8}
  .vignette{position:fixed;inset:0;pointer-events:none;box-shadow:inset 0 0 220px rgba(0,0,0,.85)}
  .scanlines{position:fixed;inset:0;pointer-events:none;background:repeating-linear-gradient(to bottom,rgba(255,255,255,.03),rgba(255,255,255,.03) 1px,transparent 1px,transparent 3px);mix-blend-mode:overlay}
  .hidden{display:none}
  .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
  .form-grid .full{grid-column:1 / -1}
  label{font-size:12px;opacity:.8;margin-bottom:6px;display:block}
  input{width:100%;padding:10px 12px;background:transparent;border:1px solid currentColor;border-radius:10px;color:inherit;font-family:inherit}
  .hint{font-size:12px;color:var(--muted);margin-top:6px}
  .ok{color:#86efac}.err{color:#fca5a5}
  .btn.sweep{position:relative;overflow:hidden}
  .btn.sweep::after{content:'';position:absolute;inset:0;background:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.35),rgba(255,255,255,0));transform:translateX(-120%)}
  .btn.sweep.animate::after{animation:sweep 1.1s ease-out forwards}
  @keyframes sweep{from{transform:translateX(-120%)}to{transform:translateX(120%)}}
  .dim{opacity:.35}
  </style>
</head>
<body>
  <div class="vignette"></div>
  <div class="scanlines"></div>

  <main class="wrap">
    <div class="card">
      <header class="header">
        <div class="header-left">
          <span class="dot"></span>
          <h1>techconsult // console</h1>
        </div>
        <div class="header-right"><span id="themeBadge" class="badge">theme: green</span></div>
      </header>

      <section id="typeArea" class="type-area"></section>

      <section id="introArea" class="hidden">
        <div class="line">&gt; Sie möchten wissen:</div>
        <div class="line">&gt; • Wo steht Ihr Unternehmen im Vergleich zu Ihrer Branche?</div>
        <div class="line">&gt; • Welche Security-Prioritäten setzen andere 2025–2026?</div>
        <div class="line">&gt; • Welche Rolle spielen unabhängige Ratings (PUR) für Wachstum?</div>
        <div class="muted">// Tippen abgeschlossen – Fortfahren…</div>
      </section>

      <section id="quizArea" class="hidden"></section>
      <section id="resultArea" class="hidden"></section>

      <footer class="footer">
        <span>techconsult – Research. Insights. Orientation.</span>
        <span>[trusted since 1992]</span>
      </footer>
    </div>
  </main>

  <script>
  const CONFIG = {
    theme: 'green',
    hall: 'Halle 7, Stand B32',
    headline: 'Willkommen bei techconsult – Research & Insights for IT-Decision Makers.',
    calendarUrl: 'https://outlook.office.com/book/techconsultGmbHNilsHoltel@techconsult.de/',
    reportEmail: 'nils.holtel@techconsult.de',
    apiUrl: '/api/lead', // <— Vercel Serverless Endpoint

    quiz: [
      {
        id: 'q1_invest',
        text: '> Wie wichtig werden Investitionen in Marktforschung & Wettbewerbsanalysen für Ihr Unternehmen bis 2026?',
        options: [
          { label: 'Sehr wichtig – wir bauen das aus', key: 'invest_high', benchmark: '62% der Anbieter investieren bis 2026 gezielt in Market Intelligence – die Orientierung wird entscheidend.' },
          { label: 'Mittel – punktuell geplant', key: 'invest_mid', benchmark: 'Viele Unternehmen planen punktuelle Analysen: Fokus auf kritische Entscheidungen und Wettbewerbssituationen.' },
          { label: 'Gering – bisher kein Fokus', key: 'invest_low', benchmark: 'Ein geringer Fokus birgt Risiko: fehlende Markttransparenz verlängert Zyklen und erschwert Priorisierung.' }
        ]
      },
      {
        id: 'q2_gtm',
        text: '> Wo erwarten Sie die größten Veränderungen in Ihrem Go-to-Market bis 2026?',
        options: [
          { label: 'Neue Zielmärkte / Branchen', key: 'gtm_newmarkets', benchmark: 'Viele Anbieter nutzen neue Verticals, um Wachstum zu beschleunigen – vorausgesetzt, Messaging & Use-Cases passen.' },
          { label: 'Vertriebsmodell neu ausrichten', key: 'gtm_salesmodel', benchmark: 'Die Neuausrichtung des Vertriebs (Direkt/Partner) wirkt stark – klare ICP-Definitionen sind der Hebel.' },
          { label: 'Marketing & Kommunikation verstärken', key: 'gtm_marketing', benchmark: '43% der Anbieter priorisieren bis 2026 eine Schärfung ihrer Marketing- & Kommunikationsstrategie.' },
          { label: 'Customer Experience ausbauen', key: 'gtm_cx', benchmark: 'Investitionen in CX wirken doppelt: Höhere Bindung und bessere Weiterempfehlungen entlang der Journey.' }
        ]
      },
      {
        id: 'q3_ratings',
        text: '> Welche Rolle spielen unabhängige User Ratings & Analysten-Benchmarks (PUR) für Sie bis 2026?',
        options: [
          { label: 'Sehr relevant – beeinflusst Marktauftritt', key: 'ratings_high', benchmark: 'Fast zwei Drittel der Anbieter setzen bis 2026 auf unabhängige Ratings, um Vertrauen am Markt aufzubauen.' },
          { label: 'Mittel – nice to have, ergänzend', key: 'ratings_mid', benchmark: 'Ergänzend eingesetzt, bieten Ratings schnelle Orientierung und stärken den Beleg im Mid-Funnel.' },
          { label: 'Niedrig – wir setzen auf andere Differenzierung', key: 'ratings_low', benchmark: 'Eigene Differenzierung kann tragen – Kombi mit externem Proof erleichtert dennoch interne Freigaben.' }
        ]
      },
      {
        id: 'q4_growth',
        text: '> Welches wird Ihr größter Hebel sein, um Ihre Marktposition bis 2026 auszubauen?',
        options: [
          { label: 'Markenbekanntheit steigern', key: 'growth_brand', benchmark: 'Brand-Invest stärkt Recall & Pull – im Vergleich steigt die Meeting-Quote bei klarer Positionierung.' },
          { label: 'Wettbewerbsposition schärfen', key: 'growth_competition', benchmark: 'Transparente Wettbewerbsvergleiche verkürzen Auswahlzyklen und unterstützen das Leadership-Narrativ.' },
          { label: 'Differenzierung über Innovation', key: 'growth_innovation', benchmark: 'Innovationsgetriebene Anbieter gewinnen in neuen Kategorien schneller Sichtbarkeit & Mindshare.' },
          { label: 'Sichtbarkeit durch Referenzen & Ratings', key: 'growth_ratings', benchmark: 'Die meisten Anbieter sehen sichtbare Differenzierung über Referenzen & Ratings als entscheidenden Growth-Faktor.' }
        ]
      }
    ]
  };

  document.documentElement.setAttribute('data-theme', CONFIG.theme === 'orange' ? 'orange' : 'green');
  document.getElementById('themeBadge').textContent = `theme: ${CONFIG.theme}`;

  const bootLines = [
    '> Accessing secure system...',
    '> Authorization: Messe-Badge NFC',
    '> Identity: Visitor detected',
    '> Status: [CLEAR]',
    '>',
    `> ${CONFIG.headline}`
  ];

  const typeArea = document.getElementById('typeArea');
  const introArea = document.getElementById('introArea');
  const resultArea = document.getElementById('resultArea');

  let runId = 0;
  const answers = {};

  function scrollToBottom(){ window.scrollTo({ top: document.body.scrollHeight, behavior:'smooth' }); }
  function typeLineInto(container, text, speed=16, myRun=runId){
    return new Promise(resolve=>{
      const lineEl=document.createElement('div'); lineEl.className='line';
      const cursor=document.createElement('span'); cursor.className='cursor';
      const textNode=document.createTextNode(''); lineEl.appendChild(textNode); lineEl.appendChild(cursor);
      container.appendChild(lineEl);
      let i=0; const tick=()=>{ if(myRun!==runId){cursor.remove();resolve('aborted');return;}
        if(i<=text.length){ textNode.textContent=text.slice(0,i); i++; setTimeout(tick,speed); }
        else { cursor.remove(); resolve('done'); }
        scrollToBottom();
      }; setTimeout(tick,140);
    });
  }
  async function typeSequence(container, lines, speed=16, gap=200, myRun=runId){
    for(const l of lines){ const r=await typeLineInto(container,l,speed,myRun); if(r==='aborted'||myRun!==runId) return 'aborted'; await new Promise(res=>setTimeout(res,gap)); if(myRun!==runId) return 'aborted'; }
    return 'done';
  }
  function insertAfter(parent,newNode,refNode){ parent.insertBefore(newNode, refNode? refNode.nextSibling : null); }

  async function showQuestion(idx, container, afterEl=null){
    const qWrap=document.createElement('div');
    const block=document.createElement('div'); block.className='block';
    const title=document.createElement('div'); title.className='block-title'; block.appendChild(title);
    const btnRow=document.createElement('div'); btnRow.className='btn-row';
    qWrap.appendChild(block); qWrap.appendChild(btnRow);
    if(afterEl && afterEl.parentNode===container) insertAfter(container,qWrap,afterEl); else container.appendChild(qWrap);
    container.classList.remove('hidden');
    const myRun=++runId; await typeLineInto(title, CONFIG.quiz[idx].text, 14, myRun); if(myRun!==runId) return;
    CONFIG.quiz[idx].options.forEach(opt=>{
      const b=document.createElement('button'); b.className='btn'; b.textContent=opt.label;
      b.addEventListener('click', ()=>handleAnswer(idx,opt,qWrap)); btnRow.appendChild(b);
    });
    scrollToBottom();
  }

  async function handleAnswer(idx,opt,qWrap){
    const myRun=++runId; const q=CONFIG.quiz[idx]; answers[q.id]=opt.label;

    const sysBlock=document.createElement('div'); sysBlock.className='block'; insertAfter(resultArea,sysBlock,qWrap);
    await typeLineInto(sysBlock, `> Auswahl bestätigt: [${opt.label.toUpperCase()}]`, 14, myRun); if(myRun!==runId) return;

    const benchBlock=document.createElement('div'); benchBlock.className='block';
    const benchTitle=document.createElement('div'); benchTitle.className='block-title'; benchTitle.textContent='> Benchmark Result:'; benchBlock.appendChild(benchTitle);
    insertAfter(resultArea,benchBlock,sysBlock);
    await typeLineInto(benchBlock, opt.benchmark, 14, myRun); if(myRun!==runId) return;

    setTimeout(()=>{ sysBlock.classList.add('dim'); }, 200);
    await new Promise(r=>setTimeout(r,600)); if(myRun!==runId) return;

    const nextIndex=idx+1; const isLast=nextIndex>=CONFIG.quiz.length;
    if(isLast){ await analyseAndMission(myRun); }
    else { showQuestion(nextIndex, resultArea, benchBlock); }
  }

  function computeProfile(){
    let innovator=0, challenger=0, builder=0;
    const q1=answers['q1_invest'];
    if(q1?.startsWith('Sehr wichtig')){ innovator+=2; builder+=1; }
    else if(q1?.startsWith('Mittel')){ challenger+=1; builder+=1; }
    else { challenger+=2; }
    const q2=answers['q2_gtm'];
    if(q2==='Marketing & Kommunikation verstärken') builder+=2;
    if(q2==='Neue Zielmärkte / Branchen') challenger+=2;
    if(q2==='Vertriebsmodell neu ausrichten') challenger+=2;
    if(q2==='Customer Experience ausbauen'){ builder+=1; innovator+=1; }
    const q3=answers['q3_ratings'];
    if(q3?.startsWith('Sehr relevant')) builder+=2; else if(q3?.startsWith('Mittel')) builder+=1; else challenger+=1;
    const q4=answers['q4_growth'];
    if(q4==='Markenbekanntheit steigern') builder+=2;
    if(q4==='Wettbewerbsposition schärfen') challenger+=2;
    if(q4==='Differenzierung über Innovation') innovator+=3;
    if(q4==='Sichtbarkeit durch Referenzen & Ratings') builder+=3;
    const scores=[{key:'Market Builder',v:builder},{key:'Innovator',v:innovator},{key:'Challenger',v:challenger}].sort((a,b)=>b.v-a.v);
    return scores[0].key;
  }

  async function analyseAndMission(myRun){
    const profile=computeProfile();
    const endBlock=document.createElement('div'); endBlock.className='block'; resultArea.appendChild(endBlock);
    await typeLineInto(endBlock, '> Analyse abgeschlossen.', 14, myRun); if(myRun!==runId) return;
    await new Promise(r=>setTimeout(r,300));
    const profBlock=document.createElement('div'); profBlock.className='block'; resultArea.appendChild(profBlock);
    await typeLineInto(profBlock, `> Ihr Zukunftsprofil 2026: [${profile}]`, 14, myRun); if(myRun!==runId) return;
    await missionSequence(myRun, true, profile);
  }

  async function missionSequence(myRun, focusCalendar=true, profile=''){
    const block2=document.createElement('div'); block2.className='block';
    const title2=document.createElement('div'); title2.className='block-title'; title2.textContent='> Mission Update:';
    const missionP=document.createElement('div'); missionP.className='text';
    block2.appendChild(title2); block2.appendChild(missionP); resultArea.appendChild(block2); scrollToBottom();
    const r2=await typeLineInto(missionP,'Sie haben die Schnell-Analyse freigeschaltet. Holen Sie sich den vollständigen Branchenreport + exklusive Insights.',14,myRun);
    if(r2==='aborted'||myRun!==runId) return;

    const btnRow=document.createElement('div'); btnRow.className='btn-row';
    const a1=document.createElement('a'); a1.className='btn sweep'; a1.id='ctaCalendar'; a1.href=CONFIG.calendarUrl; a1.target='_blank'; a1.rel='noopener noreferrer'; a1.textContent='Termin vereinbaren';
    const b2=document.createElement('button'); b2.className='btn'; b2.type='button'; b2.textContent='Individuellen Report anfragen'; b2.addEventListener('click', ()=>openReportForm());
    btnRow.appendChild(a1); btnRow.appendChild(b2); block2.appendChild(btnRow); scrollToBottom();

    if(focusCalendar){ const el=document.getElementById('ctaCalendar'); if(el){ el.scrollIntoView({behavior:'smooth',block:'center'}); el.classList.remove('animate'); void el.offsetWidth; el.classList.add('animate'); setTimeout(()=>el.classList.remove('animate'),1300); } }
  }

  // === Backend-Submit (echtes API) ===
  function openReportForm(){
    const formBlock=document.createElement('div'); formBlock.className='block';
    const title=document.createElement('div'); title.className='block-title'; title.textContent='> Kontaktformular (Individueller Report)'; formBlock.appendChild(title);
    const form=document.createElement('form'); form.setAttribute('novalidate','novalidate');
    form.innerHTML = `
      <div class="form-grid">
        <div class="full"><label for="name">Name</label><input id="name" name="name" placeholder="Vor- und Nachname" required /></div>
        <div><label for="company">Unternehmen</label><input id="company" name="company" placeholder="Firmenname" required /></div>
        <div><label for="email">Geschäftliche E-Mail</label><input id="email" name="email" placeholder="name@unternehmen.de" required /></div>
      </div>
      <div class="hint">Wir nutzen Ihre Angaben ausschließlich zur Kontaktaufnahme für den individuellen Report.</div>
      <div class="btn-row" style="margin-top:12px;">
        <button type="submit" class="btn">Anfrage senden</button>
        <button type="button" class="btn" id="closeForm">Abbrechen</button>
      </div>
      <div id="formMsg" class="hint"></div>
    `;
    form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const name=form.querySelector('#name').value.trim();
      const company=form.querySelector('#company').value.trim();
      const email=form.querySelector('#email').value.trim();
      const msg=form.querySelector('#formMsg');
      if(!name||!company||!email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){
        msg.textContent='Bitte alle Felder korrekt ausfüllen (gültige geschäftliche E-Mail).'; msg.className='hint err'; return;
      }
      msg.textContent='Wird gesendet…'; msg.className='hint';
      try{
        const payload={ name, company, email, answers: (typeof answers==='object'? answers : {}) };
        const res=await fetch(CONFIG.apiUrl,{ method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload) });
        if(!res.ok) throw new Error(await res.text());
        msg.textContent='Danke! Wir melden uns mit Ihrem individuellen Report.'; msg.className='hint ok';
        form.querySelectorAll('input,button[type="submit"]').forEach(i=>i.disabled=true);
      }catch(err){
        console.error(err);
        msg.textContent='Senden fehlgeschlagen. Bitte später erneut versuchen oder am Stand ansprechen.'; msg.className='hint err';
      }
    });
    const closeBtn=document.createElement('button'); closeBtn.type='button'; closeBtn.textContent='Formular schließen'; closeBtn.className='btn'; closeBtn.addEventListener('click',()=>{ formBlock.remove(); });
    formBlock.appendChild(form); formBlock.appendChild(closeBtn); resultArea.appendChild(formBlock); formBlock.scrollIntoView({behavior:'smooth',block:'start'});
  }

  (function boot(){
    const myRun=++runId;
    typeSequence(typeArea, bootLines, 14, 220, myRun).then(()=>{
      if(myRun!==runId) return;
      introArea.classList.remove('hidden');
      setTimeout(()=>{ if(myRun!==runId) return; showQuestion(0, resultArea); }, 600);
    });
  })();
  </script>
</body>
</html>
